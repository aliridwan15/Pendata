
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Prediksi Penyakit Jantung Menggunakan Model Pembelajaran Mesin pada Dataset Cleveland &#8212; Penambangan Data E</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'prauas';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Teknik Binning" href="binnings.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/naga.jpg" class="logo__image only-light" alt="Penambangan Data E - Home"/>
    <img src="_static/naga.jpg" class="logo__image only-dark pst-js-only" alt="Penambangan Data E - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to my github account
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Data Mining (Penambangan Data)</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_understanding.html">Data Understanding</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tugas1.html">Tugas1 Data_mining</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Tugas2.html"><strong>Tugas 2 data_understanding</strong></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Local_Outlier_Factor.html">Local Outlier Factor</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="UTS.html"><strong>UTS</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="K_Means.html">K-MEANS CLUSTER 2,3 DAN 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fuzzy_CMeans.html"><strong>FUZZY C-MEANS CLUSTERING</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="tree.html">Decision_tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="binnings.html">Teknik Binning</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Prediksi Penyakit Jantung Menggunakan Model Pembelajaran Mesin pada Dataset Cleveland</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fprauas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/prauas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Prediksi Penyakit Jantung Menggunakan Model Pembelajaran Mesin pada Dataset Cleveland</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pendahuluan">Pendahuluan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">Data Understanding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sumber-data">Sumber Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan">Tujuan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrasi-data">Integrasi Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#penjelasan-fitur">Penjelasan fitur</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">Eksplorasi Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-data">Visualisasi Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-pada-data">Klasifikasi pada Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi-model">Evaluasi Model</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="prediksi-penyakit-jantung-menggunakan-model-pembelajaran-mesin-pada-dataset-cleveland">
<h1>Prediksi Penyakit Jantung Menggunakan Model Pembelajaran Mesin pada Dataset Cleveland<a class="headerlink" href="#prediksi-penyakit-jantung-menggunakan-model-pembelajaran-mesin-pada-dataset-cleveland" title="Link to this heading">#</a></h1>
<section id="pendahuluan">
<h2>Pendahuluan<a class="headerlink" href="#pendahuluan" title="Link to this heading">#</a></h2>
<p>Penyakit jantung adalah salah satu penyebab kematian utama di seluruh dunia dan mencakup berbagai kondisi yang memengaruhi fungsi jantung. Kondisi ini dapat meliputi penyempitan pembuluh darah koroner, gangguan irama jantung, hingga kegagalan jantung. Deteksi dini penyakit jantung sangat penting untuk mencegah komplikasi serius seperti serangan jantung dan stroke. Berbagai pemeriksaan medis digunakan untuk menilai kesehatan jantung, termasuk pengukuran tekanan darah, kadar kolesterol, serta tes elektrokardiogram (EKG) yang merekam aktivitas listrik jantung.</p>
<p>Dalam konteks diagnosis, sejumlah parameter klinis dan hasil pemeriksaan tersebut dianalisis untuk menentukan ada tidaknya penyakit jantung serta tingkat keparahannya. Informasi ini sangat penting bagi dokter dalam menentukan langkah pengobatan yang tepat dan memberikan perawatan preventif bagi pasien yang berisiko tinggi. Dataset Heart Disease yang digunakan dalam penelitian ini berisi data pasien dengan berbagai fitur medis yang membantu dalam melakukan klasifikasi apakah pasien memiliki penyakit jantung atau tidak, sehingga dapat mendukung sistem pendukung keputusan medis.</p>
</section>
<section id="data-understanding">
<h2>Data Understanding<a class="headerlink" href="#data-understanding" title="Link to this heading">#</a></h2>
<section id="sumber-data">
<h3>Sumber Data<a class="headerlink" href="#sumber-data" title="Link to this heading">#</a></h3>
<p>Dataset diambil dari link berikut:</p>
<p><a class="reference external" href="https://archive.ics.uci.edu/dataset/45/heart+disease">https://archive.ics.uci.edu/dataset/45/heart+disease</a></p>
<p>Dataset Heart Disease (Cleveland) berasal dari Cleveland Clinic Foundation, yang dikumpulkan oleh David Aha pada tahun 1987. Data ini kemudian dipublikasikan melalui UCI Machine Learning Repository, yang dikelola oleh University of California, Irvine (UCI), sebagai bagian dari koleksi dataset untuk penelitian dan eksperimen pembelajaran mesin.</p>
</section>
<section id="tujuan">
<h3>Tujuan<a class="headerlink" href="#tujuan" title="Link to this heading">#</a></h3>
<p>Tujuan dari dataset Heart Disease (Cleveland) adalah untuk mengembangkan dan menguji model pembelajaran mesin yang dapat memprediksi ada tidaknya penyakit jantung pada seorang pasien berdasarkan data medis dan klinis.</p>
</section>
<section id="integrasi-data">
<h3>Integrasi Data<a class="headerlink" href="#integrasi-data" title="Link to this heading">#</a></h3>
<p>Dataset Heart Disease (Cleveland) tersedia secara publik di UCI Machine Learning Repository dan dapat diakses untuk keperluan penelitian dan pengembangan model pembelajaran mesin. Untuk mengambil data ini menggunakan Python, kita bisa memanfaatkan pustaka seperti ucimlrepo yang memudahkan pengunduhan dan integrasi dataset dari UCI secara langsung ke lingkungan pemrograman. Setelah data diimpor, kita dapat memuatnya sebagai DataFrame menggunakan pandas, sehingga data siap untuk proses eksplorasi, pembersihan, dan pelatihan model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">ucimlrepo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: ucimlrepo in /usr/local/python/3.12.1/lib/python3.12/site-packages (0.0.7)
Requirement already satisfied: pandas&gt;=1.0.0 in /home/codespace/.local/lib/python3.12/site-packages (from ucimlrepo) (2.2.3)
Requirement already satisfied: certifi&gt;=2020.12.5 in /home/codespace/.local/lib/python3.12/site-packages (from ucimlrepo) (2024.8.30)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: numpy&gt;=1.26.0 in /home/codespace/.local/lib/python3.12/site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2.2.0)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /home/codespace/.local/lib/python3.12/site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /home/codespace/.local/lib/python3.12/site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2024.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /home/codespace/.local/lib/python3.12/site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2024.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: six&gt;=1.5 in /home/codespace/.local/lib/python3.12/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=1.0.0-&gt;ucimlrepo) (1.17.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">25.0.1</span> -&gt; <span class=" -Color -Color-Green">25.1.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">python3 -m pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">KBinsDiscretizer</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="penjelasan-fitur">
<h3>Penjelasan fitur<a class="headerlink" href="#penjelasan-fitur" title="Link to this heading">#</a></h3>
<p>Dataset Heart Disease (Cleveland) berisi 14 fitur klinis dan demografis yang digunakan untuk membantu prediksi ada tidaknya penyakit jantung pada pasien. Fitur pertama adalah age, yang menunjukkan usia pasien dalam tahun. Kemudian sex merepresentasikan jenis kelamin pasien dengan nilai 1 untuk pria dan 0 untuk wanita. Fitur cp (chest pain type) mengklasifikasikan jenis nyeri dada yang dialami pasien, yang penting untuk diagnosis klinis. trestbps adalah tekanan darah sistolik saat istirahat, sementara chol mencerminkan kadar kolesterol serum pasien dalam mg/dl. Fitur fbs (fasting blood sugar) menunjukkan apakah gula darah puasa pasien lebih besar dari 120 mg/dl, yang merupakan indikator risiko diabetes. Hasil pemeriksaan elektrokardiogram saat istirahat dicatat dalam restecg, yang mengidentifikasi kelainan jantung. thalach adalah detak jantung maksimum yang dicapai pasien selama tes latihan. exang menunjukkan apakah pasien mengalami angina yang dipicu oleh olahraga. Fitur oldpeak mengukur depresi segmen ST yang diamati selama tes latihan relatif terhadap istirahat, yang merupakan indikator stres jantung. slope menggambarkan kemiringan segmen ST selama latihan, yang membantu menilai risiko. Fitur ca mencatat jumlah pembuluh darah utama yang terlihat tersumbat berdasarkan fluoroskopi. Terakhir, thal adalah hasil tes thallium, yang mengindikasikan abnormalitas jantung seperti cacat permanen atau reversibel. Target variabel num menunjukkan keberadaan penyakit jantung dengan nilai 0 berarti tidak ada penyakit dan nilai 1 sampai 4 menunjukkan adanya penyakit dengan tingkat keparahan berbeda.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Fetch dataset Heart Disease</span>
<span class="n">heart_disease</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Ambil fitur dan target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span>

<span class="c1"># Gabungkan fitur dan target menjadi satu DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Simpan ke CSV</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;heart-disease.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Tampilkan metadata fitur dalam tabel (DataFrame)</span>
<span class="n">feature_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">heart_disease</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Informasi fitur:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">feature_info</span><span class="p">[[</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">]])</span>

<span class="c1"># Tampilkan 5 data teratas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5 data teratas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Informasi fitur:
                 type                                        description
name                                                                    
age           Integer                                               None
sex       Categorical                                               None
cp        Categorical                                               None
trestbps      Integer  resting blood pressure (on admission to the ho...
chol          Integer                                  serum cholestoral
fbs       Categorical                    fasting blood sugar &gt; 120 mg/dl
restecg   Categorical                                               None
thalach       Integer                        maximum heart rate achieved
exang     Categorical                            exercise induced angina
oldpeak       Integer  ST depression induced by exercise relative to ...
slope     Categorical                                               None
ca            Integer  number of major vessels (0-3) colored by flour...
thal      Categorical                                               None
num           Integer                         diagnosis of heart disease

5 data teratas:
   age  sex  cp  trestbps  chol  fbs  restecg  thalach  exang  oldpeak  slope  \
0   63    1   1       145   233    1        2      150      0      2.3      3   
1   67    1   4       160   286    0        2      108      1      1.5      2   
2   67    1   4       120   229    0        2      129      1      2.6      2   
3   37    1   3       130   250    0        0      187      0      3.5      3   
4   41    0   2       130   204    0        2      172      0      1.4      1   

    ca  thal  num  
0  0.0   6.0    0  
1  3.0   3.0    2  
2  2.0   7.0    1  
3  0.0   3.0    0  
4  0.0   3.0    0  
</pre></div>
</div>
</div>
</div>
</section>
<section id="eksplorasi-data">
<h3>Eksplorasi Data<a class="headerlink" href="#eksplorasi-data" title="Link to this heading">#</a></h3>
<p>Kode di bawah ini melakukan eksplorasi data awal dengan beberapa langkah penting. Pertama, kode memeriksa jumlah missing value pada setiap kolom untuk mengetahui apakah terdapat data yang hilang dan perlu penanganan. Selanjutnya, kode menampilkan tipe data dari setiap kolom untuk memastikan bahwa tipe data sudah sesuai dengan harapan dan mendukung analisis lebih lanjut. Kemudian, kode menyajikan statistik deskriptif yang meliputi nilai rata-rata, median, dan kuartil, yang membantu dalam memahami sebaran data dan mendeteksi nilai ekstrem secara kasar. Untuk identifikasi outlier secara lebih sistematis, kode menggunakan fungsi detect_outliers_iqr yang mengimplementasikan metode Interquartile Range (IQR). Fungsi ini menghitung jumlah nilai yang berada di luar batas bawah dan atas (ditentukan oleh 1,5 kali IQR dari kuartil pertama dan ketiga) untuk setiap fitur numerik. Terakhir, kode menampilkan jumlah outlier untuk setiap kolom numerik berdasarkan hasil deteksi tersebut, memberikan gambaran awal tentang keberadaan nilai ekstrem yang dapat mempengaruhi analisis dan pemodelan berikutnya.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cek missing value</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Jumlah missing value per kolom:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># Cek tipe data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tipe data setiap kolom:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>

<span class="c1"># Statistik deskriptif (cek sebaran, deteksi outlier kasar)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Statistik deskriptif:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># Deteksi outlier (nilai ekstrem) via IQR</span>
<span class="k">def</span> <span class="nf">detect_outliers_iqr</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
    <span class="n">Q1</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">Q3</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
    <span class="n">outliers</span> <span class="o">=</span> <span class="p">((</span><span class="n">column</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">column</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">outliers</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Jumlah outlier per fitur numerik (berdasarkan IQR):&quot;</span><span class="p">)</span>
<span class="n">numerical_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numerical_cols</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">detect_outliers_iqr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span><span class="si">}</span><span class="s2"> outlier&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah missing value per kolom:
age         0
sex         0
cp          0
trestbps    0
chol        0
fbs         0
restecg     0
thalach     0
exang       0
oldpeak     0
slope       0
ca          4
thal        2
num         0
dtype: int64

Tipe data setiap kolom:
age           int64
sex           int64
cp            int64
trestbps      int64
chol          int64
fbs           int64
restecg       int64
thalach       int64
exang         int64
oldpeak     float64
slope         int64
ca          float64
thal        float64
num           int64
dtype: object

Statistik deskriptif:
              age         sex          cp    trestbps        chol         fbs  \
count  303.000000  303.000000  303.000000  303.000000  303.000000  303.000000   
mean    54.438944    0.679868    3.158416  131.689769  246.693069    0.148515   
std      9.038662    0.467299    0.960126   17.599748   51.776918    0.356198   
min     29.000000    0.000000    1.000000   94.000000  126.000000    0.000000   
25%     48.000000    0.000000    3.000000  120.000000  211.000000    0.000000   
50%     56.000000    1.000000    3.000000  130.000000  241.000000    0.000000   
75%     61.000000    1.000000    4.000000  140.000000  275.000000    0.000000   
max     77.000000    1.000000    4.000000  200.000000  564.000000    1.000000   

          restecg     thalach       exang     oldpeak       slope          ca  \
count  303.000000  303.000000  303.000000  303.000000  303.000000  299.000000   
mean     0.990099  149.607261    0.326733    1.039604    1.600660    0.672241   
std      0.994971   22.875003    0.469794    1.161075    0.616226    0.937438   
min      0.000000   71.000000    0.000000    0.000000    1.000000    0.000000   
25%      0.000000  133.500000    0.000000    0.000000    1.000000    0.000000   
50%      1.000000  153.000000    0.000000    0.800000    2.000000    0.000000   
75%      2.000000  166.000000    1.000000    1.600000    2.000000    1.000000   
max      2.000000  202.000000    1.000000    6.200000    3.000000    3.000000   

             thal         num  
count  301.000000  303.000000  
mean     4.734219    0.937294  
std      1.939706    1.228536  
min      3.000000    0.000000  
25%      3.000000    0.000000  
50%      3.000000    0.000000  
75%      7.000000    2.000000  
max      7.000000    4.000000  

Jumlah outlier per fitur numerik (berdasarkan IQR):
age: 0 outlier
sex: 0 outlier
cp: 23 outlier
trestbps: 9 outlier
chol: 5 outlier
fbs: 45 outlier
restecg: 0 outlier
thalach: 1 outlier
exang: 0 outlier
oldpeak: 5 outlier
slope: 0 outlier
ca: 20 outlier
thal: 0 outlier
num: 0 outlier
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualisasi-data">
<h3>Visualisasi Data<a class="headerlink" href="#visualisasi-data" title="Link to this heading">#</a></h3>
<p>Kode di bawah ini bertujuan untuk melakukan visualisasi data guna memahami distribusi dan hubungan antar fitur dalam dataset penyakit jantung. Pertama, visualisasi menggunakan countplot memperlihatkan distribusi kelas target num, yang mengindikasikan jumlah pasien dengan dan tanpa penyakit jantung, sehingga memudahkan analisis proporsi kelas dalam data. Selanjutnya, sebuah heatmap korelasi menampilkan hubungan statistik antar fitur numerik dengan nilai korelasi yang diannotasi, membantu mengidentifikasi fitur-fitur yang saling berhubungan kuat atau lemah, yang penting untuk pemilihan fitur dalam pemodelan. Terakhir, dengan menggunakan histogram, kode ini menggambarkan distribusi sebaran nilai pada beberapa fitur numerik utama seperti usia, tekanan darah, kolesterol, denyut jantung maksimum, dan depresi ST (oldpeak), sehingga memberikan gambaran visual tentang pola dan variasi data yang ada pada masing-masing fitur tersebut.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisasi distribusi target &#39;num&#39; (penyakit jantung)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribusi Kelas Target (num)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Penyakit Jantung (0 = Tidak, 1+ = Ya)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Jumlah Pasien&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Visualisasi korelasi antar fitur numerik</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.2f&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriks Korelasi Fitur&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Histogram beberapa fitur numerik</span>
<span class="n">numerical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;trestbps&#39;</span><span class="p">,</span> <span class="s1">&#39;chol&#39;</span><span class="p">,</span> <span class="s1">&#39;thalach&#39;</span><span class="p">,</span> <span class="s1">&#39;oldpeak&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="n">numerical_features</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Histogram Fitur Numerik&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08dcc43d7ad81b33eb226913b5dc797a9b13fd78399a622146e07fcff18b0208.png" src="_images/08dcc43d7ad81b33eb226913b5dc797a9b13fd78399a622146e07fcff18b0208.png" />
<img alt="_images/d459f620526207a55768068e52e0eda5eed2fed3d5da9aed7b145fd40d678103.png" src="_images/d459f620526207a55768068e52e0eda5eed2fed3d5da9aed7b145fd40d678103.png" />
<img alt="_images/049cfc308f19a668e8a739c6de8d4863af37dcbb24b8a9191da19940130114f4.png" src="_images/049cfc308f19a668e8a739c6de8d4863af37dcbb24b8a9191da19940130114f4.png" />
</div>
</div>
</section>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading">#</a></h2>
<p>Kode di bawah ini melakukan tahapan preprocessing data yang penting untuk mempersiapkan dataset sebelum analisis atau pemodelan. Pertama, kode menggunakan metode imputasi dengan strategi rata-rata (<code class="docutils literal notranslate"><span class="pre">mean</span></code>) untuk mengisi nilai-nilai yang hilang (missing values) pada seluruh kolom dataset, sehingga data menjadi lengkap dan siap diproses lebih lanjut. Selanjutnya, kode melakukan normalisasi pada fitur numerik menggunakan <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> untuk mengubah skala data agar memiliki distribusi dengan rata-rata nol dan standar deviasi satu, yang membantu model belajar dengan lebih efektif; kolom target sengaja dikecualikan dari proses ini. Kemudian, secara opsional kode melakukan binning pada fitur usia (<code class="docutils literal notranslate"><span class="pre">age</span></code>), dengan mengelompokkan usia ke dalam kategori ‘muda’, ‘dewasa’, dan ‘lanjut’ berdasarkan rentang nilai tertentu, sehingga dapat digunakan sebagai fitur kategorikal tambahan. Terakhir, hasil preprocessing ini ditampilkan untuk memastikan bahwa imputasi, normalisasi, dan binning telah dilakukan dengan benar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># 1. Imputasi missing value dengan rata-rata</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">df_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># 2. Normalisasi fitur numerik (drop &#39;target&#39; jika ada)</span>
<span class="n">numerical_cols</span> <span class="o">=</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">df_imputed</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_imputed</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">])</span>

<span class="c1"># 3. (Opsional) Binning usia</span>
<span class="k">if</span> <span class="s1">&#39;age&#39;</span> <span class="ow">in</span> <span class="n">df_imputed</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;age_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;muda&#39;</span><span class="p">,</span> <span class="s1">&#39;dewasa&#39;</span><span class="p">,</span> <span class="s1">&#39;lanjut&#39;</span><span class="p">])</span>

<span class="c1"># Cek hasil akhir</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Hasil preprocessing:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hasil preprocessing:
        age       sex        cp  trestbps      chol       fbs   restecg  \
0  0.948726  0.686202 -2.251775  0.757525 -0.264900  2.394438  1.016684   
1  1.392002  0.686202  0.877985  1.611220  0.760415 -0.417635  1.016684   
2  1.392002  0.686202  0.877985 -0.665300 -0.342283 -0.417635  1.016684   
3 -1.932564  0.686202 -0.165268 -0.096170  0.063974 -0.417635 -0.996749   
4 -1.489288 -1.457296 -1.208521 -0.096170 -0.825922 -0.417635  1.016684   

    thalach     exang   oldpeak     slope        ca      thal       num  \
0  0.017197 -0.696631  1.087338  2.274579 -0.723095  0.655818 -0.764198   
1 -1.821905  1.435481  0.397182  0.649113  2.503851 -0.898522  0.866450   
2 -0.902354  1.435481  1.346147  0.649113  1.428203  1.173931  0.051126   
3  1.637359 -0.696631  2.122573  2.274579 -0.723095 -0.898522 -0.764198   
4  0.980537 -0.696631  0.310912 -0.976352 -0.723095 -0.898522 -0.764198   

  age_bin  
0    muda  
1    muda  
2    muda  
3     NaN  
4     NaN  
</pre></div>
</div>
</div>
</div>
</section>
<section id="klasifikasi-pada-data">
<h2>Klasifikasi pada Data<a class="headerlink" href="#klasifikasi-pada-data" title="Link to this heading">#</a></h2>
<p>Kode di bawah ini menjelaskan proses lengkap pengambilan data, preprocessing, pelatihan beberapa model klasifikasi, serta prediksi dan tampilan hasil pada dataset penyakit jantung. Pertama, dataset diambil menggunakan pustaka <code class="docutils literal notranslate"><span class="pre">ucimlrepo</span></code>, kemudian target variabel diubah menjadi bentuk biner, yaitu 1 untuk pasien yang mengidap penyakit jantung dan 0 untuk yang tidak. Selanjutnya, nilai yang hilang pada fitur diimputasi dengan rata-rata agar data menjadi lengkap, kemudian fitur numerik dinormalisasi menggunakan MinMaxScaler untuk menyesuaikan skala nilai antar fitur. Data kemudian dibagi menjadi subset pelatihan dan pengujian dengan proporsi 80:20, mempertahankan distribusi kelas target yang seimbang. Setelah itu, tiga model klasifikasi—Gaussian Naive Bayes, Decision Tree, dan Support Vector Machine—didefinisikan dan dilatih menggunakan data latih. Setiap model kemudian melakukan prediksi pada data uji, dan hasil prediksi bersama sebagian data latih, data uji, serta label asli ditampilkan untuk memberikan gambaran tentang performa dan keluaran model. Proses ini memungkinkan evaluasi awal model secara visual dan numerik untuk pemilihan model terbaik dalam memprediksi penyakit jantung.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span>

<span class="c1"># ----------------------------------</span>
<span class="c1"># 1. Load dan Preprocessing Data</span>
<span class="c1"># ----------------------------------</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>  <span class="c1"># Dataset Heart Disease</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span>

<span class="c1"># Binerisasi target: 1 jika sakit, 0 jika tidak</span>
<span class="n">target_col</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y_binary</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Imputasi missing values dengan mean (kalau ada)</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">X_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Normalisasi fitur numerik dengan MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_imputed</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Split data latih &amp; uji</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_scaled</span><span class="p">,</span> <span class="n">y_binary</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_binary</span><span class="p">)</span>

<span class="c1"># ----------------------------------</span>
<span class="c1"># 2. Definisikan model</span>
<span class="c1"># ----------------------------------</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Gaussian Naive Bayes&quot;</span><span class="p">:</span> <span class="n">GaussianNB</span><span class="p">(),</span>
    <span class="s2">&quot;Decision Tree&quot;</span><span class="p">:</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="s2">&quot;Support Vector Machine&quot;</span><span class="p">:</span> <span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># ----------------------------------</span>
<span class="c1"># 3. Training, Prediksi dan Tampilkan Data &amp; Hasil</span>
<span class="c1"># ----------------------------------</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Training</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="c1"># Prediksi</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1"># Tampilkan sebagian data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh X_train:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh X_test:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh y_test:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh y_pred:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
Model: Gaussian Naive Bayes

Contoh X_train:
        age  sex        cp  trestbps      chol  fbs  restecg   thalach  exang  \
111  0.5625  1.0  1.000000  0.292453  0.280822  1.0      1.0  0.557252    1.0   
52   0.3125  1.0  1.000000  0.169811  0.374429  0.0      1.0  0.625954    0.0   
173  0.6875  0.0  1.000000  0.433962  0.611872  0.0      1.0  0.656489    0.0   
138  0.1250  1.0  1.000000  0.245283  0.164384  0.0      0.0  0.450382    1.0   
11   0.5625  0.0  0.333333  0.433962  0.383562  0.0      1.0  0.625954    0.0   

      oldpeak  slope        ca  thal  
111  0.193548    0.5  0.333333   0.0  
52   0.000000    0.0  0.333333   0.0  
173  0.193548    0.5  0.000000   0.0  
138  0.258065    0.5  0.000000   1.0  
11   0.209677    0.5  0.000000   0.0  

Contoh X_test:
          age  sex        cp  trestbps      chol  fbs  restecg   thalach  \
125  0.333333  0.0  0.333333  0.339623  0.246575  0.0      1.0  0.793893   
83   0.812500  1.0  0.666667  0.811321  0.337900  1.0      1.0  0.603053   
53   0.312500  1.0  0.333333  0.339623  0.212329  0.0      1.0  0.893130   
45   0.604167  1.0  0.666667  0.169811  0.237443  0.0      1.0  0.717557   
248  0.479167  1.0  1.000000  0.292453  0.196347  0.0      0.0  0.740458   

     exang   oldpeak  slope        ca  thal  
125    0.0  0.096774    0.5  0.000000   0.0  
83     1.0  0.258065    0.5  0.000000   1.0  
53     0.0  0.000000    0.0  0.000000   0.0  
45     0.0  0.403226    0.5  0.333333   1.0  
248    0.0  0.161290    0.0  0.666667   1.0  

Contoh y_test:
[0, 1, 0, 1, 1]

Contoh y_pred:
[0, 1, 0, 1, 1]
============================================================
Model: Decision Tree

Contoh X_train:
        age  sex        cp  trestbps      chol  fbs  restecg   thalach  exang  \
111  0.5625  1.0  1.000000  0.292453  0.280822  1.0      1.0  0.557252    1.0   
52   0.3125  1.0  1.000000  0.169811  0.374429  0.0      1.0  0.625954    0.0   
173  0.6875  0.0  1.000000  0.433962  0.611872  0.0      1.0  0.656489    0.0   
138  0.1250  1.0  1.000000  0.245283  0.164384  0.0      0.0  0.450382    1.0   
11   0.5625  0.0  0.333333  0.433962  0.383562  0.0      1.0  0.625954    0.0   

      oldpeak  slope        ca  thal  
111  0.193548    0.5  0.333333   0.0  
52   0.000000    0.0  0.333333   0.0  
173  0.193548    0.5  0.000000   0.0  
138  0.258065    0.5  0.000000   1.0  
11   0.209677    0.5  0.000000   0.0  

Contoh X_test:
          age  sex        cp  trestbps      chol  fbs  restecg   thalach  \
125  0.333333  0.0  0.333333  0.339623  0.246575  0.0      1.0  0.793893   
83   0.812500  1.0  0.666667  0.811321  0.337900  1.0      1.0  0.603053   
53   0.312500  1.0  0.333333  0.339623  0.212329  0.0      1.0  0.893130   
45   0.604167  1.0  0.666667  0.169811  0.237443  0.0      1.0  0.717557   
248  0.479167  1.0  1.000000  0.292453  0.196347  0.0      0.0  0.740458   

     exang   oldpeak  slope        ca  thal  
125    0.0  0.096774    0.5  0.000000   0.0  
83     1.0  0.258065    0.5  0.000000   1.0  
53     0.0  0.000000    0.0  0.000000   0.0  
45     0.0  0.403226    0.5  0.333333   1.0  
248    0.0  0.161290    0.0  0.666667   1.0  

Contoh y_test:
[0, 1, 0, 1, 1]

Contoh y_pred:
[0, 0, 0, 1, 1]
============================================================
Model: Support Vector Machine

Contoh X_train:
        age  sex        cp  trestbps      chol  fbs  restecg   thalach  exang  \
111  0.5625  1.0  1.000000  0.292453  0.280822  1.0      1.0  0.557252    1.0   
52   0.3125  1.0  1.000000  0.169811  0.374429  0.0      1.0  0.625954    0.0   
173  0.6875  0.0  1.000000  0.433962  0.611872  0.0      1.0  0.656489    0.0   
138  0.1250  1.0  1.000000  0.245283  0.164384  0.0      0.0  0.450382    1.0   
11   0.5625  0.0  0.333333  0.433962  0.383562  0.0      1.0  0.625954    0.0   

      oldpeak  slope        ca  thal  
111  0.193548    0.5  0.333333   0.0  
52   0.000000    0.0  0.333333   0.0  
173  0.193548    0.5  0.000000   0.0  
138  0.258065    0.5  0.000000   1.0  
11   0.209677    0.5  0.000000   0.0  

Contoh X_test:
          age  sex        cp  trestbps      chol  fbs  restecg   thalach  \
125  0.333333  0.0  0.333333  0.339623  0.246575  0.0      1.0  0.793893   
83   0.812500  1.0  0.666667  0.811321  0.337900  1.0      1.0  0.603053   
53   0.312500  1.0  0.333333  0.339623  0.212329  0.0      1.0  0.893130   
45   0.604167  1.0  0.666667  0.169811  0.237443  0.0      1.0  0.717557   
248  0.479167  1.0  1.000000  0.292453  0.196347  0.0      0.0  0.740458   

     exang   oldpeak  slope        ca  thal  
125    0.0  0.096774    0.5  0.000000   0.0  
83     1.0  0.258065    0.5  0.000000   1.0  
53     0.0  0.000000    0.0  0.000000   0.0  
45     0.0  0.403226    0.5  0.333333   1.0  
248    0.0  0.161290    0.0  0.666667   1.0  

Contoh y_test:
[0, 1, 0, 1, 1]

Contoh y_pred:
[0, 1, 0, 1, 1]
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluasi-model">
<h2>Evaluasi Model<a class="headerlink" href="#evaluasi-model" title="Link to this heading">#</a></h2>
<p>Kode ini menguraikan proses lengkap mulai dari pengambilan data hingga evaluasi model klasifikasi untuk mendeteksi penyakit jantung. Pertama, dataset diunduh menggunakan pustaka <code class="docutils literal notranslate"><span class="pre">ucimlrepo</span></code>, kemudian target variabel diubah menjadi format biner agar model dapat membedakan pasien dengan dan tanpa penyakit jantung. Selanjutnya, nilai yang hilang pada fitur diisi menggunakan imputasi rata-rata, dan fitur numerik dinormalisasi dengan MinMaxScaler untuk menyetarakan skala data. Data dibagi menjadi subset pelatihan dan pengujian dengan proporsi 80:20, memastikan distribusi kelas tetap seimbang. Tiga model klasifikasi, yaitu Gaussian Naive Bayes, Decision Tree, dan Support Vector Machine, didefinisikan dan dilatih pada data latih. Setelah itu, masing-masing model melakukan prediksi pada data uji, dan sebagian data uji serta hasil prediksi ditampilkan untuk memberikan gambaran keluaran model. Untuk mengukur performa model secara menyeluruh, fungsi evaluasi menghitung dan menampilkan metrik akurasi, presisi, recall, dan F1-score, serta menampilkan classification report dan confusion matrix yang divisualisasikan dengan heatmap, sehingga memudahkan analisis kekuatan dan kelemahan tiap model dalam klasifikasi penyakit jantung.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span>

<span class="c1"># ----------------------------------</span>
<span class="c1"># Fungsi Evaluasi Model</span>
<span class="c1"># ----------------------------------</span>
<span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evaluasi </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Akurasi       : </span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision    : </span><span class="si">{</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall       : </span><span class="si">{</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-Score     : </span><span class="si">{</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification Report:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

    <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Confusion Matrix - </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ----------------------------------</span>
<span class="c1"># Load dan Preprocessing Data</span>
<span class="c1"># ----------------------------------</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>  <span class="c1"># Dataset Heart Disease</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span>

<span class="c1"># Binerisasi target: 1 jika sakit, 0 jika tidak</span>
<span class="n">target_col</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y_binary</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Imputasi missing values dengan mean (kalau ada)</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">X_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Normalisasi fitur numerik dengan MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_imputed</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Split data latih &amp; uji</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_scaled</span><span class="p">,</span> <span class="n">y_binary</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_binary</span><span class="p">)</span>

<span class="c1"># ----------------------------------</span>
<span class="c1"># Definisikan model</span>
<span class="c1"># ----------------------------------</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Gaussian Naive Bayes&quot;</span><span class="p">:</span> <span class="n">GaussianNB</span><span class="p">(),</span>
    <span class="s2">&quot;Decision Tree&quot;</span><span class="p">:</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="s2">&quot;Support Vector Machine&quot;</span><span class="p">:</span> <span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># ----------------------------------</span>
<span class="c1"># Training, Prediksi dan Evaluasi</span>
<span class="c1"># ----------------------------------</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Training</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="c1"># Prediksi</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1"># Tampilkan sebagian data dan hasil prediksi</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh X_test:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh y_test:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contoh y_pred:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="c1"># Evaluasi model (print metrik dan plot confusion matrix)</span>
    <span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
Model: Gaussian Naive Bayes

Contoh X_test:
          age  sex        cp  trestbps      chol  fbs  restecg   thalach  \
125  0.333333  0.0  0.333333  0.339623  0.246575  0.0      1.0  0.793893   
83   0.812500  1.0  0.666667  0.811321  0.337900  1.0      1.0  0.603053   
53   0.312500  1.0  0.333333  0.339623  0.212329  0.0      1.0  0.893130   
45   0.604167  1.0  0.666667  0.169811  0.237443  0.0      1.0  0.717557   
248  0.479167  1.0  1.000000  0.292453  0.196347  0.0      0.0  0.740458   

     exang   oldpeak  slope        ca  thal  
125    0.0  0.096774    0.5  0.000000   0.0  
83     1.0  0.258065    0.5  0.000000   1.0  
53     0.0  0.000000    0.0  0.000000   0.0  
45     0.0  0.403226    0.5  0.333333   1.0  
248    0.0  0.161290    0.0  0.666667   1.0  

Contoh y_test:
[0, 1, 0, 1, 1]

Contoh y_pred:
[0, 1, 0, 1, 1]
============================================================
Evaluasi Gaussian Naive Bayes
Akurasi       : 0.9180
Precision    : 0.8966
Recall       : 0.9286
F1-Score     : 0.9123

Classification Report:
              precision    recall  f1-score   support

           0       0.94      0.91      0.92        33
           1       0.90      0.93      0.91        28

    accuracy                           0.92        61
   macro avg       0.92      0.92      0.92        61
weighted avg       0.92      0.92      0.92        61
</pre></div>
</div>
<img alt="_images/7ef22c84deb3d7693e2c843b95c494cb811a66386c4580d6b9da71bb978e816b.png" src="_images/7ef22c84deb3d7693e2c843b95c494cb811a66386c4580d6b9da71bb978e816b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
Model: Decision Tree

Contoh X_test:
          age  sex        cp  trestbps      chol  fbs  restecg   thalach  \
125  0.333333  0.0  0.333333  0.339623  0.246575  0.0      1.0  0.793893   
83   0.812500  1.0  0.666667  0.811321  0.337900  1.0      1.0  0.603053   
53   0.312500  1.0  0.333333  0.339623  0.212329  0.0      1.0  0.893130   
45   0.604167  1.0  0.666667  0.169811  0.237443  0.0      1.0  0.717557   
248  0.479167  1.0  1.000000  0.292453  0.196347  0.0      0.0  0.740458   

     exang   oldpeak  slope        ca  thal  
125    0.0  0.096774    0.5  0.000000   0.0  
83     1.0  0.258065    0.5  0.000000   1.0  
53     0.0  0.000000    0.0  0.000000   0.0  
45     0.0  0.403226    0.5  0.333333   1.0  
248    0.0  0.161290    0.0  0.666667   1.0  

Contoh y_test:
[0, 1, 0, 1, 1]

Contoh y_pred:
[0, 0, 0, 1, 1]
============================================================
Evaluasi Decision Tree
Akurasi       : 0.7377
Precision    : 0.7500
Recall       : 0.6429
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F1-Score     : 0.6923

Classification Report:
              precision    recall  f1-score   support

           0       0.73      0.82      0.77        33
           1       0.75      0.64      0.69        28

    accuracy                           0.74        61
   macro avg       0.74      0.73      0.73        61
weighted avg       0.74      0.74      0.74        61
</pre></div>
</div>
<img alt="_images/89d3ea48e02b8482ea44ea070c7be5268acb75a34775d4b51ac69f32a380f42f.png" src="_images/89d3ea48e02b8482ea44ea070c7be5268acb75a34775d4b51ac69f32a380f42f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
Model: Support Vector Machine

Contoh X_test:
          age  sex        cp  trestbps      chol  fbs  restecg   thalach  \
125  0.333333  0.0  0.333333  0.339623  0.246575  0.0      1.0  0.793893   
83   0.812500  1.0  0.666667  0.811321  0.337900  1.0      1.0  0.603053   
53   0.312500  1.0  0.333333  0.339623  0.212329  0.0      1.0  0.893130   
45   0.604167  1.0  0.666667  0.169811  0.237443  0.0      1.0  0.717557   
248  0.479167  1.0  1.000000  0.292453  0.196347  0.0      0.0  0.740458   

     exang   oldpeak  slope        ca  thal  
125    0.0  0.096774    0.5  0.000000   0.0  
83     1.0  0.258065    0.5  0.000000   1.0  
53     0.0  0.000000    0.0  0.000000   0.0  
45     0.0  0.403226    0.5  0.333333   1.0  
248    0.0  0.161290    0.0  0.666667   1.0  

Contoh y_test:
[0, 1, 0, 1, 1]

Contoh y_pred:
[0, 1, 0, 1, 1]
============================================================
Evaluasi Support Vector Machine
Akurasi       : 0.8361
Precision    : 0.8462
Recall       : 0.7857
F1-Score     : 0.8148

Classification Report:
              precision    recall  f1-score   support

           0       0.83      0.88      0.85        33
           1       0.85      0.79      0.81        28

    accuracy                           0.84        61
   macro avg       0.84      0.83      0.83        61
weighted avg       0.84      0.84      0.84        61
</pre></div>
</div>
<img alt="_images/bba634ee72b7fa5c4893b1d04ea3b52f61829678c28fd8a1b9c29cfe5af04040.png" src="_images/bba634ee72b7fa5c4893b1d04ea3b52f61829678c28fd8a1b9c29cfe5af04040.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="binnings.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Teknik Binning</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pendahuluan">Pendahuluan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">Data Understanding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sumber-data">Sumber Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan">Tujuan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrasi-data">Integrasi Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#penjelasan-fitur">Penjelasan fitur</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">Eksplorasi Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-data">Visualisasi Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-pada-data">Klasifikasi pada Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi-model">Evaluasi Model</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By aliridwan15
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>